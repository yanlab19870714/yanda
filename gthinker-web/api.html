<!DOCTYPE html>
<html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>G-thinker</title>

<link rel="stylesheet" id="bootstrap-css-css" href="lib/bootstrap.css" type="text/css" media="all">
<link rel="stylesheet" id="frontend_main-css-css" href="lib/frontend_main.css" type="text/css" media="all">
<link rel="stylesheet" id="social-icons-widget-widget-css" href="lib/social_icons_widget.css" type="text/css" media="all">
<link rel="stylesheet" id="twentysixteen-fonts-css" href="lib/css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="lib/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="twentysixteen-style-css" href="lib/style.css" type="text/css" media="all">
<link rel="stylesheet" href="lib/prism.css" type="text/css" media="all">

<script type="text/javascript" src="lib/jquery.js"></script>
<script type="text/javascript" src="lib/jquery-migrate.min.js"></script>
<script type="text/javascript" src="lib/js"></script>
<script type="text/javascript" src="lib/init_map.js"></script>
<script type="text/javascript" src="lib/frontend_main.js"></script>
<script type="text/javascript" src="lib/prism.js"></script>

<style type="text/css" id="wp-custom-css">

.icdeparagraph {
text-align: justify;
}

.site-title {
  text-align: center;
  margin-left: 30px;
  vertical-align: top;
  display: inline;
}

span.site-title {
   margin-left: 0px;
}

div.site-branding {
  margin-bottom: 0px !important;
}

.custom-logo-link {
  display: inline;
}

p.site-title a {
 font-size: 2.5rem !important;
 font-weight: bold;
}

a[href="https://wordpress.org/"]{ visibility: hidden; }

div.header-image {
 margin-top: 0px !important;
}

#masthead {
 padding-bottom: 37px !important;
}

div.site-info {
 width: 385px;
 overflow: hidden;
 height: 25px;
}

#vicechairs {
  width: 100%;
  border: 0px;
}

#vicechairs tbody tr td {
  border: 0px;
}

#vicechairs thead tr th {
  vertical-align: middle;
  text-align: center;
}

#hotels {
  width: 100%;
  text-align: center;
}

#thhotelsname {
  width: 40%;
}

#hotels thead tr th {
  vertical-align: middle;
  text-align: center;
}

#hotels tbody tr td {
  text-align: center;
  vertical-align: middle;
}
ul, ol{
  padding-left: 20px !important;
}

table.sightseeing {
  border: none;
}

table.sightseeing tr{
  border: none;
}

table.sightseeing tr td {
  border: none;
}


table.sightseeing tbody tr td{
  text-align: center;
}

#colophon .site-info {
  min-width: 370px;
}

ul.importantdates {
list-style-type: none;
}

#researchpc {
  width: 100%;
  border: 0px;
}


#researchpc tbody tr td{
  border: 0px;
}

#researchpc tbody tr td:nth-child(1) {
  width: 35%;
}

#researchpc tbody tr td:nth-child(2) {
  width: 65%;
}

.site-description {
    margin-left: 160px; 
    margin-top: -25px;
    margin-bottom: 10px;
}

p.site-description {
	font-size: 1.25rem;
}

#twitter-follow-3 { 
  margin-bottom: 5px;
}

#text-11 {
 margin-bottom: 15px;
}

.twitter-timeline-profile {
  max-height: 225px !important;
  overflow: scroll;
}

/* Portrait tablet to landscape and desktop */
@media (min-width: 768px) and (max-width: 1280px) {    
  p.site-title a {
   font-size: 2.5rem !important;
   font-weight: normal;
 }
}

/* Landscape phone to portrait tablet */
@media (max-width: 800px) { 
   .site-description {
      display: none;
    }
}

/* Landscape phones and down */
@media (max-width: 480px) { 
 
}

del{
color : red;
font-weight: bold;
}

.organizers{
margin-top: 0px;
margin-bottom: 25px;
}

h5 {
margin-bottom: 0px !important;
}

h6 {
	margin-bottom:5px !important;
	font-style: normal !important;
	line-height: 175% !important;
}

a.btn {
    display: inline-block;
    font-weight: bold;
    width: auto;
    color: #fff;
    background-color: #02A99C;
    cursor: pointer;
    padding: 10px 20px;
    transition: ease all 0.5s;
}

a.btn:hover, a.btn:focus {
    background: #FCB027;
    border: none;
}

</style>

<script type="text/javascript" charset="utf-8" async="" src="lib/button.5f64a1a5864e1229f84c8defd65341b4.js"></script><script type="text/javascript" charset="utf-8" async="" src="lib/timeline.25e3f797ea5047ab5a8d06fd6ee7f701.js"></script><script type="text/javascript" charset="UTF-8" src="lib/common.js"></script><script type="text/javascript" charset="UTF-8" src="lib/util.js"></script><script type="text/javascript" charset="UTF-8" src="lib/stats.js"></script></head>

<body class="home page-template-default page page-id-30 page-parent wp-custom-logo" data-gr-c-s-loaded="true">
<div id="page" class="site">
	<div class="site-inner">

<header id="masthead" class="site-header" role="banner">
	<div class="site-header-main">
		<div class="site-branding">
			<a href="index.html" class="custom-logo-link" rel="home" itemprop="url"><img width="120" src="img/logo.png" class="custom-logo" alt="G-thinker" itemprop="logo"></a>
				<p class="site-title"><a href="index.html" rel="home">Think Like a Subgraph</a></p>
				<p class="site-description">A User-Friendly Parallel Graph Mining System</a></p>
		</div><!-- .site-branding -->

<button id="menu-toggle" class="menu-toggle">Menu</button>

<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Primary Menu">
<div class="menu-main-container"><ul id="menu-main" class="primary-menu">

<li id="menu-item-33" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home current-menu-item page_item page-item-30 current_page_item menu-item-has-children menu-item-33" aria-haspopup="true"><a href="index.html">Home</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
  <li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="index.html">G-thinker Home</a></li>
</ul>
</li>

<li id="menu-item-173" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-173" aria-haspopup="true"><a href="system.html">Downloads</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
	<li id="menu-item-173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-173"><a href="system.html">System Code</a></li>
	<li id="menu-item-174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-174"><a href="toy.html">Datasets</a></li>
	<li id="menu-item-176" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-176"><a href="app.html">Application Code</a></li>
</ul>
</li>

<li id="menu-item-52" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-52" aria-haspopup="true"><a href="deploy.html">Doumentation</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
	<li id="menu-item-163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-163"><a href="deploy.html">How to Deploy</a></li>
	<li id="menu-item-164" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-164"><a href="run.html">How to Run</a></li>
	<li id="menu-item-166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-166"><a href="manual.html">How to Program</a></li>
  <li id="menu-item-166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-166"><a href="api.html">The Complete API</a></li>
</ul>
</li>

<li id="menu-item-52" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-62" aria-haspopup="true"><a href="team.html">Team &amp; Contact</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
	<li id="menu-item-63" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-63"><a href="team.html">Core Team</a></li>
	<li id="menu-item-64" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-64"><a href="others.html">Other Contributors</a></li>
</ul>
</li>

</ul></div>

</nav><!-- .main-navigation -->
</div><!-- .site-header-menu -->
</div><!-- .site-header-main -->

</header><!-- .site-header -->




<div id="content" class="site-content">
<div id="primary" class="content-area">
<main id="main" class="site-main" role="main">
		
<article id="post-30" class="post-30 page type-page status-publish hentry">

<header class="entry-header"><h1 class="entry-title">G-thinker API</h1></header><!-- .entry-header -->

<div class="entry-content">

<p class="icdeparagraph">
Other Documentations: [<a href="deploy.html">How to Deploy</a>], [<a href="run.html">How to Run</a>], [<a href="manual.html">How to Program</a>]
</p>

<p class="icdeparagraph">
This page is for <b>quick reference</b> if you are writing a G-thinker program. If you have not read our <a href="manual.html" target="_blank">programming manual</a> yet, it is strongly recommended to read through that webpage first.
</p>

<p class="icdeparagraph">
If you need help with <b>debugging</b> when facing segment faults, we recommend to use <a href="http://valgrind.org/docs/manual/mc-manual.html" target="_blank">Valgrind</a> (compile with "-g", enable "--error-limit=no" and ignore JVM memory-leak errors caused by libhdfs before graph is loaded).
</p>

<h3 class="entry-title">Workflow for writing a G-thinker program</h3>

<p class="icdeparagraph">
The workflow of writing a G-thinker program is given as follows. We will describe our APIs in this order.
<br><br>
<img src="img/flowchart.png" width="500"/>
<br><br>
The best exercise is to study our application code for <a href="https://github.com/yanlab19870714/G-thinker/blob/master/app_triangle/run.cpp" target="_blank">Triangle Counting</a>, <a href="https://github.com/yanlab19870714/G-thinker/blob/master/app_maxclique/run.cpp" target="_blank">Maximum Clique Finding</a> and <a href="https://github.com/yanlab19870714/G-thinker/blob/master/app_gmatch/run.cpp" target="_blank">Subgraph Matching</a>.
</p>

<h3 class="entry-title">The Vertex class</h3>

<pre><code class="language-cpp">template &lt;class KeyT, class ValueT, class HashT = DefaultHash&lt;KeyT&gt; &gt;
//KeyT: data type of vertex ID
//ValueT: data type of adjacency list
//If KeyT = VertexID (defined in util/global.h), HashT can be omitted
class Vertex {
public:
  KeyT id; //vertex ID field
  ValueT value; //adjacency list field

  ...
};
</code></pre>

<h3 class="entry-title">The Subgraph class</h3>

<pre><code class="language-cpp">template &lt;VertexT&gt;
//VertexT: please provide the above user-specified vertex class
class Subgraph{
public:
  typedef typename VertexT::KeyType KeyT;
  typedef typename VertexT::ValueType ValueT;
  ...

  //Add (deep-copy) a vertex object into the current subgraph
  void addVertex(VertexT & vertex);

  //A vertex with ID <i>vid</i> exists in the current subgraph?
  bool hasVertex(KeyT vid);

  //Return the vertex with ID <i>id</i> in the current subgraph
  //If exists, return a pointer to the vertex
  //Otherwise, return NULL
  VertexT * getVertex(KeyT id);

  ...
};
</code></pre>

<h3 class="entry-title">The Task class</h3>

<pre><code class="language-cpp">template &lt;class VertexT, class ContextT = char&gt;
//VertexT: please provide the previous user-specified vertex class
//ContextT (optional): provide the type of data that a task keeps
class Task {
public:
  ...
  typedef typename VertexT::KeyType KeyT;
  ...

  typedef Subgraph<VertexT> SubgraphT;
  ...

  SubgraphT subG;
  ContextT context;
  ...

  //Request for the vertex object with ID = id
  //for use by the current task's next iteration of compute(.)
  void pull(KeyT id)
  ...
};
</code></pre>

<h3 class="entry-title">The Trimmer class</h3>

<pre><code class="language-cpp">template &lt;class VertexT&gt;
//VertexT: please provide the previous user-specified vertex class
class Trimmer {
public:
  //please specify how to trim a vertex object's adjacency list
  virtual void trim(VertexT & v) = 0; //UDF
};
</code></pre>

<h3 class="entry-title">The Aggregator class</h3>

<pre><code class="language-cpp">template &lt;class ValueT, class PartialT, class FinalT&gt;
//ValueT: the type of data to be aggregated to the aggregator
//PartialT: the type of local aggregator's status
//FinalT: the type of globally aggregated status
class Aggregator {
public:
  //how to initiate the fields of an aggregator object
  //usually called at the very beginning of a job
  virtual void init() = 0; //UDF1

  //usually called in Comper::compute(.)
  //to aggregate value "context" to the aggregator
  virtual void aggregate_udf(ValueT & context) = 0; //UDF2
  //thread-safe wrapper of UDF2
  void aggregate(ValueT & context);

  //called when local aggregators synchronize their statuses
  //worker 0 gathers statuses of workers 1, 2, ..., and
  //calls stepFinal_udf(.) once using each received status as input
  virtual void stepFinal_udf(PartialT & part) = 0; //UDF3
  //thread-safe wrapper of UDF3
  void stepFinal(PartialT & part); //usually for internal use

  //returns the status of the current local aggregator
  //called by workers 1, 2, ...
  virtual void finishPartial_udf(PartialT & collector) = 0; //UDF4
  //thread-safe wrapper of UDF4
  virtual void finishPartial(PartialT & collector);

  //returns the global status obtained by synchronization
  //called by worker 0
  virtual void finishFinal_udf(FinalT & collector) = 0; //UDF5
  //thread-safe wrapper of UDF5
  virtual void finishFinal(FinalT & collector);

  //the input is the global status obtained by synchronization
  //init_udf(.) is called after each synchronization
  //to update the local aggregator's status if necessary
  virtual void init_udf(FinalT & prev) = 0; //UDF6
  //thread-safe wrapper of UDF6
  void init_aggSync(FinalT & prev); //usually for internal use
};
</code></pre>

<h3 class="entry-title">The Comper class</h3>

<pre><code class="language-cpp">template &lt;class TaskT, class AggregatorT = DummyAgg&gt;
//TaskT: please provide the previous user-specified task class
//AggregatorT (optional): provide the above user-specified aggregator class
class Comper {
public:
  ...
  //UDF1: how to spawn task(s) from a vertex <i>v</i>?
  virtual void task_spawn(VertexT * v) = 0;
  //UDF2
  virtual bool compute(SubgraphT & g, ContextT & context, vector<VertexT *> & frontier) = 0;
  ...

  //what can be used in the UDFs?

  ofstream fout; //can be used to output anything to a local file
  //to pull a vertex for the current task for use in next iteration:
  void pull(KeyT id); //only for use in UDF2
  AggregatorT* get_aggregator(); //get (pointer to) the local aggregator
  void add_task(TaskT * task) //add a task to the comper's task queue
};
</code></pre>

<h3 class="entry-title">The Worker class</h3>

<pre><code class="language-cpp">template &lt;class Comper&gt;
//Comper: please provide the above user-specified comper subclass
class Worker
{
public:
  ...
  //constructor:
  Worker(int comper_num, string local_disk_path = "buffered_tasks", string report_path = "report");
  //comper_num: number of comper threads run by each worker/machine
  //local_disk_path: path of the directory under which spilled tasks are buffered
  //report_path: path of the directory under which Comper::fout outputs to the files
  ...

  //bind with a trimmer object
  void setTrimmer(TrimmerT* trimmer);
  //bind with an aggregator object
  void setAggregator(AggregatorT* ag);
  //get the local aggregator object
  AggregatorT* get_aggregator();
  ...

  //UDFs:
  //how to parse a line into a vertex object?
  virtual VertexT* toVertex(char* line) = 0;
  //how to spawn task(s) from vertex <i>v</i> and add them to <i>tvec</i>
  virtual void task_spawn(VertexT * v, vector<TaskT> & tvec) = 0;
  ...

  //to start a job
  void run(const WorkerParams& params);
  //params.input_path should contain the path of the input data on HDFS
};
</code></pre>

<h3 class="entry-title">Global variables and functions</h3>

<p class="icdeparagraph">
Header file "<a href="https://github.com/yanlab19870714/G-thinker/blob/master/system/util/global.h" target="_blank">util/global.h</a>" is typically included to every program file, and thus the global variables and functions defined there can be accessed anywhere. Below are some global variables and functions that may be useful:
</p>

<pre><code class="language-cpp">//you can directly use hash_map and hash_set because:
...
#include &lt;ext/hash_set&gt;
#include &lt;ext/hash_map&gt;
...
#define hash_map __gnu_cxx::hash_map
#define hash_set __gnu_cxx::hash_set
...

int _my_rank; //the rank (i.e. ID) of the current worker
//rank is the terminology of MPI
int _num_workers; //the total number of workers
//the above two variables are set by the following function
//the function must be called at the begining of the main() function
void init_worker(int * argc, char*** argv);
//the following function must be called at the end of main()
void worker_finalize()
...

struct WorkerParams {
    //input graph's path on HDFS:
    string input_path;
    //whether to overwrite an existing output path on HDFS:
    bool force_write;
    bool native_dispatcher; //just set to false
    ...
};

//vertex ID's type (int by default)
typedef int VertexID;
//if a 64-bit ID is needed, you may change "int" to "long long"
...
</code></pre>

</div><!-- .entry-content -->

</article><!-- #post-## -->

</main><!-- .site-main -->
</div><!-- .content-area -->



<aside id="secondary" class="sidebar widget-area" role="complementary">

<section id="text-12" class="widget widget_text">
<h2 class="widget-title">Quick Links</h2>
<div class="textwidget">
<h4>
<p><a href="system.html">Downloads</a></p>
<p><a href="deploy.html">How to Deploy</a></p>
<p><a href="run.html">How to Run</a></p>
<p><a href="manual.html">How to Program</a></p>
<p><a href="team.html" target="_blank">Contact Us</a></p>
</h4>
</div>
</section>

<section id="text-12" class="widget widget_text">
<h2 class="widget-title">Sponsors</h2>
<div class="textwidget">
<h4>
<input type="image" width="120" src="img/nsf.png" style="cursor:pointer" onMouseover= "this.style.opacity=0.6" onMouseout= "this.style.opacity=1" onclick ="window.open('https://nsf.gov/awardsearch/showAward?AWD_ID=1755464&HistoricalAwards=false')"/>
<p></p>
<input type="image" width="180" src="img/azure.png" style="cursor:pointer" onMouseover= "this.style.opacity=0.6" onMouseout= "this.style.opacity=1" onclick ="window.open('https://www.microsoft.com/en-us/research/academic-program/azure-research-award-south-bd-hub/')"/>
<p></p>
<input type="image" width="260" src="img/south.png" style="cursor:pointer" onMouseover= "this.style.opacity=0.6" onMouseout= "this.style.opacity=1" onclick ="window.open('https://southbdhub.wordpress.com/2017/12/04/south-hub-microsoft-team-up-to-provide-azure-credits-for-researchers/')"/>
</h4>
</div>
</section>

</aside><!-- .sidebar .widget-area -->
</div><!-- .site-content -->


<footer id="colophon" class="site-footer" role="contentinfo">
<nav class="main-navigation" role="navigation" aria-label="Footer Primary Menu">

<div class="menu-main-container">
<ul id="menu-main-1" class="primary-menu">

<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home current-menu-item page_item page-item-30 current_page_item menu-item-has-children menu-item-33" aria-haspopup="true"><a href="index.html">Home</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
  <li id="menu-item-36" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35"><a href="index.html">G-thinker Home</a></li>
</ul>
</li>

<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-52" aria-haspopup="true"><a href="system.html">Downloads</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
	<li id="menu-item-173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-173"><a href="system.html">System Code</a></li>
  <li id="menu-item-174" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-174"><a href="toy.html">Datasets</a></li>
  <li id="menu-item-176" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-176"><a href="app.html">Application Code</a></li>
</ul>
</li>

<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-160" aria-haspopup="true"><a href="deploy.html">Doumentation</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>

<ul class="sub-menu">
	<li id="menu-item-163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-163"><a href="deploy.html">How to Deploy</a></li>
  <li id="menu-item-164" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-164"><a href="run.html">How to Run</a></li>
  <li id="menu-item-166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-166"><a href="manual.html">How to Program</a></li>
  <li id="menu-item-166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-166"><a href="api.html">The Complete API</a></li>
</ul>
</li>

<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-173" aria-haspopup="true"><a href="team.html">Team &amp; Contact</a><button class="dropdown-toggle" aria-expanded="false"><span class="screen-reader-text">expand child menu</span></button>
<ul class="sub-menu">
	<li id="menu-item-63" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-63"><a href="team.html">Core Team</a></li>
  <li id="menu-item-64" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-64"><a href="others.html">Other Contributors</a></li>
</ul>
</li>

</ul></div>
</nav><!-- .main-navigation -->
			
			
<div class="site-info">
	<span class="site-title"><a href="index.html" rel="home">G-thinker: A User-Friendly Parallel Graph Mining System</a></span>
</div><!-- .site-info -->

</footer><!-- .site-footer -->
</div><!-- .site-inner -->
</div><!-- .site -->

<script type="text/javascript" src="lib/skip-link-focus-fix.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var screenReaderText = {"expand":"expand child menu","collapse":"collapse child menu"};
/* ]]> */
</script>
<script type="text/javascript" src="lib/functions.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
window.twttr=(function(w){t=w.twttr||{};t._e=[];t.ready=function(f){t._e.push(f);};return t;}(window));
/* ]]> */
</script>
<script type="text/javascript" id="twitter-wjs" async="" defer="" src="lib/widgets.js" charset="utf-8"></script>
<script type="text/javascript" src="lib/wp-embed.min.js"></script>

</body>
</html>